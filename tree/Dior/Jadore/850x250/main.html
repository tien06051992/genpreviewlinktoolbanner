<!DOCTYPE html>
<html>
	<head>
		<link type="text/css" rel="stylesheet" href="css/style.css">
	</head>

	<!--content-->

	<body>
		<div id="container" class="container">
			<div class="video-container">
				<div id="vidHolder">
					<video height="250">
					  <source src="media/970x250.mp4" type="video/mp4">
					  Your browser does not support HTML5 video.
					</video>
				</div>
			</div>
			<img class="watch" src="images/discover.png">
		    <div class="end-frame">
		        <img class="copy-end" src="images/endframe.jpg">
		        <img src="images/endlogo.png" class="end-logo">
		        <img src="images/cta.png" class="cta">
		    </div>
		    <div class="controls">
		        <div class="play-btn">
		            <img class="replay-img" src="images/replay.png">
		            <img class="play-img" src="images/play.png">
		            <img class="pause-img" src="images/pause.png">
		        </div>
		        <div class="sound-btn">
		            <img class="sound-on-img" src="images/sound-on.png">
		            <img class="sound-off-img" src="images/sound-off.png">
		        </div>
		    </div>
		    <img src="images/shadow.jpg" class="shadow">
		    <div id="clickArea" target="_blank"></div>
		</div>

		<!--scripts-->
		<script src="scripts/html5API.js"></script>
		<script type="text/javascript">

			// declare HTML elements
			container = myFT.$("#container"),

			// declare video objects
			vidHolder = myFT.$("#vidHolder");

			// apply clickTags
			myFT.applyClickTag(clickArea, 1);

			

			/* 
			 * Custom script
			 * created by tienle
			 */
			 var isMute = true;
			 var isPlayed = true;
			 var currentTime = 0;
			 var cue1,cue2,video1,TimeLine;

			 
			function startAd() {
				
				clickArea = myFT.$("#clickArea"),
				playPauseBtn = document.querySelector(".play-btn");
				soundBtn = document.querySelector(".sound-btn");
			    imgPlay = document.querySelector(".play-img");
			    imgPause = document.querySelector(".pause-img");
			    imgReplay = document.querySelector(".replay-img");
			    imgSoundOn = document.querySelector(".sound-on-img");
			    imgSoundOff = document.querySelector(".sound-off-img");
			    endFrame = document.querySelector(".end-frame");
			    copyEnd = document.querySelector(".copy-end");
			    cta = document.querySelector(".cta");
			    videoContainer = document.querySelector(".video-container");
			    controls = document.querySelector(".controls");
			    video1 = document.querySelector("video");
			    watch = document.querySelector(".watch");
			    endLogo = document.querySelector(".end-logo");

			    video1.play();
			    controls.style.visibility = "visible";
			    tooglePlayIcons();
			    toogleSoundIcons();
			    addListeners();
			    setCuePoints();
			    TimeLine = setInterval(function(){timeline()},10);
			    //timeline();

			}

			function setCuePoints() {
			    cue1 = 1.02;
			    cue2 = 7.99;
			}

			function timeline() {
			    video1.onended = function() {
			        replayVideo();
			        soundBtn.style.opacity = "0";
			    };

			    checkCuePoints();

			    function checkCuePoints() {
			    	currentTime += 0.01;
			    	console.log(currentTime);
			        if (currentTime <= cue1) {
			            watch.style.opacity = "0";
			        }
			        else if (currentTime >= cue2) {
			            endFrame.style.opacity = "1";
			            copyEnd.className = "copy-end fade-in";
			            setTimeout(function() {
			                endLogo.className = "end-logo fade-in";    
			            }, 700);
			            setTimeout(function() {
			                cta.className = "cta fade-in";    
			            }, 1400);
			            watch.style.opacity = "0";
			        } else {
			            endFrame.style.opacity = "0";
			            copyEnd.className = "copy-end";
			            endLogo.className = "end-logo";
			            cta.className = "cta";
			            watch.style.opacity = "1";
			        }
			    }
			}

			// // ---------Play|Pause|Replay controls----------------------------------------------------------
			function tooglePlayIcons() {
			    if (isPlayed) {
			        imgPlay.style.opacity = 0;
			        imgPause.style.opacity = 1;
			        imgReplay.style.opacity = 0;
					imgReplay.style.zIndex = "initial";
			    } else {
			        imgPlay.style.opacity = 1;
			        imgPause.style.opacity = 0;
			        imgReplay.style.opacity = 0;
					imgReplay.style.zIndex = "initial";
			    }
			}

			function tooglePlayPause() {
			    if (isPlayed) {
			        video1.pause();
			        isPlayed = false;
			        clearInterval(TimeLine);
			    } else {
			        video1.play();
			        isPlayed = true;
			        TimeLine = setInterval(function(){timeline()},10);
			    }
			    tooglePlayIcons();
			    soundBtn.style.opacity = "1";
			    watch.style.opacity = "1";
			}

			// // ---------Video controls----------------------------------------------------------
			function toogleSoundIcons() {
			    if (!isMute) {
			        imgSoundOn.style.opacity = 0;
			        imgSoundOff.style.opacity = 1;
			    } else {
			        imgSoundOn.style.opacity = 1;
			        imgSoundOff.style.opacity = 0;
			    }
			}

			function toogleSound() {
			    if (!isMute) {
			        video1.mute();
			        isMute = true;
			    } else {
			        video1.unmute();
			        isMute = false;
			    }
			    toogleSoundIcons();
			}

			function addListeners() {
			    soundBtn.addEventListener("click", toogleSound, false);
				imgReplay.addEventListener("click", replayAd, true);
			    playPauseBtn.addEventListener("click", tooglePlayPause, false);
			}

			function replayVideo() {
				clearInterval(TimeLine);
			    imgPlay.style.opacity = 0;
			    imgPause.style.opacity = 0;
			    imgReplay.style.opacity = 1;
				imgReplay.style.zIndex="99";
				//currentTime=0;
				//startAd();
			}

			function replayAd(e){
				clearInterval(TimeLine);
				currentTime=0;
				endFrame.style.opacity=0;
				soundBtn.style.opacity = "1";
				startAd();
				e.stopPropagation();
				return false;
			}


			 window.addEventListener("load", startAd);

		</script>
	</body>
</html>
